{# templates/components/core/accounts/password_reset_confirm/component.html #}
{% load i18n %}
<section class="auth-wrap auth-slot" data-auth-screen>
  <header class="auth-header">
    <h1 class="auth-title">{{ title|default:_("Définir un nouveau mot de passe") }}</h1>
  </header>

  {% if messages %}
    <div class="auth-alerts" role="status" aria-live="polite">
      {% for message in messages %}
        <div class="alert {{ message.tags }}">{{ message }}</div>
      {% endfor %}
    </div>
  {% endif %}

  <div class="auth-card">
    {% if not validlink %}
      <div class="alert error">{% trans "Ce lien de réinitialisation est invalide ou expiré." %}</div>
      <div class="meta-links">
        <a href="{{ links.request }}">{% trans "Demander un nouveau lien" %}</a>
      </div>
    {% else %}
      {% if non_field_errors %}
        <div class="alert error" role="alert">{{ non_field_errors_text }}</div>
      {% endif %}

      <form class="auth-form" method="post" action="{{ action_url }}" novalidate>
        {% csrf_token %}
        <div class="field">
          <label for="confirm_id_password1">{% trans "Nouveau mot de passe" %}</label>
          {% with error=field_errors_text.new_password1 %}
            <div class="password-field">
              <input id="confirm_id_password1"
                     name="new_password1"
                     type="password"
                     autocomplete="new-password"
                     required
                     aria-invalid="{{ error|yesno:'true,false' }}"
                     {% if error %}aria-describedby="confirm_err_password1"{% endif %}>
              <button type="button"
                      class="pw-toggle"
                      aria-controls="confirm_id_password1"
                      aria-label="{% trans 'Afficher le mot de passe' %}"
                      data-label-hide="{% trans 'Masquer le mot de passe' %}">👁</button>
            </div>
            <small class="caps-hint">{% trans "Verr Maj activée" %}</small>
            {% if error %}
              <div class="alert error field-error" id="confirm_err_password1">{{ error }}</div>
            {% endif %}
          {% endwith %}
        </div>

        <div class="field">
          <label for="confirm_id_password2">{% trans "Confirmer le mot de passe" %}</label>
          {% with error=field_errors_text.new_password2 %}
            <div class="password-field">
              <input id="confirm_id_password2"
                     name="new_password2"
                     type="password"
                     autocomplete="new-password"
                     required
                     aria-invalid="{{ error|yesno:'true,false' }}"
                     {% if error %}aria-describedby="confirm_err_password2"{% endif %}>
              <button type="button"
                      class="pw-toggle"
                      aria-controls="confirm_id_password2"
                      aria-label="{% trans 'Afficher le mot de passe' %}"
                      data-label-hide="{% trans 'Masquer le mot de passe' %}">👁</button>
            </div>
            <small class="caps-hint">{% trans "Verr Maj activée" %}</small>
            {% if error %}
              <div class="alert error field-error" id="confirm_err_password2">{{ error }}</div>
            {% endif %}
          {% endwith %}
        </div>

        <div class="auth-actions">
          <button class="btn-primary" type="submit">{% trans "Enregistrer" %}</button>
        </div>
      </form>
    {% endif %}
  </div>
</section>
